select md5(md5(CASE WHEN n.nspname ::text IS NULL THEN ' ' ELSE n.nspname::text END) ||md5(CASE WHEN g.usename ::text IS NULL THEN ' ' ELSE g.usename::text END) ||md5(CASE WHEN n.oid  ::text IS NULL THEN ' ' ELSE n.oid::text END) ::text ) as guid,     CASE           WHEN n.nspname like 'emcas%' THEN 'Y'  ELSE 'N'          END AS workspaceschema,              CASE           WHEN n.nspname IN('public','account_admin','dba_work','pg_aoseg','pg_toast','pg_bitmapindex','workfile','pg_catalog')       THEN 'Y'  ELSE 'N'          END AS systemschema,                 CASE           WHEN n.nspname not like 'emcas%' and n.nspname not in('public','account_admin') THEN 'Y'  ELSE 'N'          END AS hubschema,              n.nspname  as schemaname ,g.usename as ownername,d.description,(select datname from pg_database where datname like '%bdl%') containedInDB       from pg_namespace n LEFT JOIN pg_user as g ON (g.usesysid =n.nspowner) LEFT JOIN pg_description d on n.oid = d.objoid   